@baseUrl = http://localhost:3000/api/v1
@contentType = application/json

# =======================================================
# SECTION 1: AUTHENTICATION (EMPLOYER)
# =======================================================

### 1. Register Employer Baru
POST {{baseUrl}}/register
Content-Type: {{contentType}}

{
  "name": "StartUp Maju Jaya",
  "email": "ceo@majujaya.com",
  "password": "password123",
  "role": "EMPLOYER"
}

### 2. Login Employer (AMBIL TOKENNYA!)
# @name loginEmployer
POST {{baseUrl}}/login
Content-Type: {{contentType}}

{
  "email": "ceo@majujaya.com",
  "password": "password123"
}

#### VARIABLE TOKEN EMPLOYER
@employerToken = {{loginEmployer.response.body.token}}


# =======================================================
# SECTION 2: JOB POSTING FLOW
# =======================================================

### 3. Post Job Baru (Status Awal: UNPAID)
# Pastikan kamu sudah login sebagai Employer
POST {{baseUrl}}/jobs
Authorization: Bearer {{employerToken}}
Content-Type: {{contentType}}

{
  "title": "Fullstack fronend & backend developer",
  "description": "Mencari developer handal untuk membangun aplikasi web kami.",
  "location": "Bandung (Hybrid)",
  "latitude": -6.8,
  "longitude": 107.8,
  "salary": 9000000,
  "jobType": "FULL_TIME",
  "maxApplicants": 1,
  "deadline": "2027-12-31T23:59:00Z"
}

# =======================================================
# SECTION 3: SIMULASI PEMBAYARAN (WEBHOOK CHEAT)
# =======================================================

### 4. Tembak Webhook Manual (Pura-pura jadi Midtrans)
# PENTING: Ganti "order_id" di bawah dengan ID yang muncul di terminal servermu
# contoh: "JOBPOST-1-1732xxxx"
POST {{baseUrl}}/notifications/midtrans
Content-Type: {{contentType}}

{
  "order_id": "GANTI_DENGAN_ORDER_ID_DARI_TERMINAL", 
  "transaction_status": "settlement",
  "fraud_status": "accept",
  "status_code": "200",
  "gross_amount": "50000.00"
}

# =======================================================
# SECTION 4: AUTHENTICATION (WORKER)
# =======================================================

### 5. Register Worker Baru
POST {{baseUrl}}/register
Content-Type: {{contentType}}

{
  "name": "Budi Si Rajin",
  "email": "budi@worker.com",
  "password": "password123",
  "role": "WORKER"
}

### 6. Login Worker (AMBIL TOKENNYA!)
# @name loginWorker
POST {{baseUrl}}/login
Content-Type: {{contentType}}

{
  "email": "budi@worker.com",
  "password": "password123"
}

#### VARIABLE TOKEN WORKER
@workerToken = {{loginWorker.response.body.token}}


# =======================================================
# SECTION 5: APPLY JOB FLOW
# =======================================================

### 7. Worker Melamar Pekerjaan
# Ganti angka '1' di URL dengan ID Job yang valid
POST {{baseUrl}}/jobs/1/apply
Authorization: Bearer {{workerToken}}
Content-Type: {{contentType}}

{} 
# ^^^ PENTING: Kurung kurawal kosong ini wajib ada agar tidak error "Bad Request"


# =======================================================
# SECTION 6: EMPLOYER REVIEW
# =======================================================

### 8. Employer Melihat Pelamar
# Ganti angka '1' di URL dengan ID Job yang valid
GET {{baseUrl}}/jobs/1/applicants
Authorization: Bearer {{employerToken}}

# =======================================================
# SECTION 7: EMPLOYER DECISION (ACCEPT / REJECT)
# =======================================================

### 9. Employer Menerima Pelamar (ACCEPTED)
# Ganti angka '1' di URL dengan ID APPLICATION (Dapat dari response request No. 8)
PATCH {{baseUrl}}/applications/1/status
Authorization: Bearer {{employerToken}}
Content-Type: {{contentType}}

{
  "status": "ACCEPTED"
}

### 10. Employer Menolak Pelamar (REJECTED)
# Gunakan ID Application yang berbeda atau reset database jika ingin tes ulang
PATCH {{baseUrl}}/applications/1/status
Authorization: Bearer {{employerToken}}
Content-Type: {{contentType}}

{
  "status": "REJECTED"
}


### 11. Beli Paket Langganan (ENTRY / MID / HIGH)
POST {{baseUrl}}/subscriptions
Authorization: Bearer {{employerToken}}
Content-Type: {{contentType}}

{
  "tier": "MID"
}

# =======================================================
# SECTION 9: BUY ONE-TIME QUOTA (ECERAN)
# =======================================================

### 12. Beli Kuota Satuan
POST {{baseUrl}}/quotas
Authorization: Bearer {{employerToken}}
Content-Type: {{contentType}}

{
  "quantity": 10
}

### Post Quest (Pakai Subscription)
POST {{baseUrl}}/quests
Authorization: Bearer {{employerToken}}
Content-Type: {{contentType}}

{
  "title": "Buat Logo Vector",
  "description": "Logo minimalis berbentuk kucing.",
  "tier": "MID",
  "maxSubmissions": 5,
  "deadline": "2024-12-30T00:00:00Z",
  "quotaType": "SUBSCRIPTION"
}

### Post Quest (Pakai One Time Quota)
POST {{baseUrl}}/quests
Authorization: Bearer {{employerToken}}
Content-Type: {{contentType}}

{
  "title": "membuat tampilan landing page",
  "description": "Artikel teknologi 500 kata.",
  "tier": "ENTRY",
  "maxSubmissions": 10,
  "deadline": "2027-12-25T00:00:00Z",
  "quotaType": "ONE_TIME"
}

# =======================================================
# SECTION: PUBLIC BROWSING (JOBS & QUESTS)
# =======================================================

### 1. Ambil Semua Job (Tanpa Filter)
GET {{baseUrl}}/jobs

### 2. Cari Job Spesifik (Filter)
# Mencari job dengan kata "Backend", lokasi "Bandung", Tipe "FULL_TIME"
GET {{baseUrl}}/jobs?search=Backend&location=Bandung&type=FULL_TIME

### 3. Ambil Semua Quest (Tanpa Filter)
GET {{baseUrl}}/quests

### 4. Cari Quest Spesifik
# Mencari quest dengan Tier "MID" dan halaman ke-1
GET {{baseUrl}}/quests?tier=MID&page=1&limit=5

### 4. Cari Quest Spesifik
# Mencari quest dengan Tier "MID" dan halaman ke-1

GET {{baseUrl}}/jobs?userLat=-6.8&userLong=107.81

# =======================================================
# SECTION 10: WORKER QUEST ACTIONS
# =======================================================

### 13. Worker Memulai Quest (Status: IN_PROGRESS)
# Ganti angka ID Quest yang valid (misal: 1)
POST {{baseUrl}}/quests/3/start
Authorization: Bearer {{workerToken}}
Content-Type: {{contentType}}

{}

### 14. Worker Submit Quest (Upload File)
# Request ini mensimulasikan upload file text sederhana.
# Pastikan ID Quest sama dengan yang di-start (misal: 1)
POST {{baseUrl}}/quests/3/submit
Authorization: Bearer {{workerToken}}
Content-Type: multipart/form-data; boundary=MfnBound

--MfnBound
Content-Disposition: form-data; name="file"; filename="submission.txt"
Content-Type: text/plain

Ini adalah hasil pengerjaan quest saya.
--MfnBound--

# =======================================================
# SECTION 11: EMPLOYER ASSESSMENT & PORTFOLIO
# =======================================================

### 15. Employer Menilai Submission (Assess)
# Ganti ID SUBMISSION (Cek response submit atau DB, misal: 1)
PATCH {{baseUrl}}/submissions/2/assess
Authorization: Bearer {{employerToken}}
Content-Type: {{contentType}}

{
  "isApproved": false,
  "rating": 1,
  "feedback": "Hasil tidak memuaskan, quest tidak sesuai dengan deskripsi."
}

### 16. Lihat Portfolio User (All)
# Ganti angka 2 dengan UserID yang valid (Worker)
GET {{baseUrl}}/portfolios/2

### 17. Lihat Detail Portfolio User
# Ganti angka 2 dengan UserID, dan 1 dengan PortfolioID
GET {{baseUrl}}/portfolios/2/1